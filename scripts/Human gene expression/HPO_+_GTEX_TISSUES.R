
###############################################################################################################################
###############################################################################################################################

### Project: PhenoExpression ##################################################################################################
### Script: HPO_+_GTEX_TISSUES.R ###################################################################################################
### Purpose: To make dataframe with the GTEX.Tissues and their corresponding HPO terms ########################################################
### Author: Friha Zafar ####################################################################################################
### Date: 18/06/2019 ##########################################################################################################

###############################################################################################################################
###############################################################################################################################

## load packages ##############################################################################################################

library(dplyr);library(tidyr);library(readr);library(tidyverse);library(ggpubr)

################################################################################################################################
################################################################################################################################

# Load Files

human_0.1_pheno<-read_csv("D:/MSC RESEARCH PROJECT/Output_Files/Human/Expression_0.1/human_genes_TPM_0.1_pheno.csv")

## load 'clean_df' function:

source(file="D:/MSC RESEARCH PROJECT/Scripts/Human+Mouse/clean_df_FUNCTION.R")




############################################################################################################################################################
################################################################################################################################################

#####~~~~~~~~~~~~~~~~~~~~~~~~~~~Clean the Human data~~~~~~~~~~~~~~~~~~#
## Use function to clean the dfs

human_0.1_pheno_cleaned <-clean_df(human_0.1_pheno)

names(human_0.1_pheno_cleaned)[names(human_0.1_pheno_cleaned)=="Expression"] <- "TPM >/= 0.1 TPM"

names(human_0.1_pheno_cleaned)[names(human_0.1_pheno_cleaned)=="HPO.superclass.description"] <- "HPO.Top.Level"


View(human_0.1_pheno_cleaned)


HPO.GTEX<-human_0.1_pheno_cleaned%>%
  select(GTEX.tissues, HPO.Top.Level)%>%
  distinct()

View(HPO.GTEX)


write.csv(HPO.GTEX, './Output_Files/Human/HPO.GTEX.csv')